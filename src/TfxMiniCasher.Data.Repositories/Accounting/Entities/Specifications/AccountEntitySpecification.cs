using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Metadata.Builders;
using Xyz.TForce.Data;

namespace Xyz.TForce.MiniCasher.Data.Repositories.Accounting.Entities.Specifications
{

  public class AccountEntitySpecification : IEntityTypeConfiguration<Account>
  {

    public void Configure(EntityTypeBuilder<Account> builder)
    {
      builder.MapToTable("Accounting_Accounts");
      builder.PrimaryKey(x => x.Id,isAutoGenerated: true);
      builder.Index(x => x.AccountId, name: "UX_AccountId", isUnique: true);
      builder.Require(x => x.AccountId);
      builder.Index(x => x.AccountCode, name: "UX_AccountCode", isUnique: true);
      builder.MaxLength(x => x.AccountCode, ColumnLengths.KeyLength);
      builder.Require(x => x.AccountCode);
      builder.MaxLength(x => x.AccountName, ColumnLengths.NameLength);
      builder.Require(x => x.AccountName);
      builder.MaxLength(x => x.AccountDescription, ColumnLengths.SummaryLength);
      builder.ManyToOne(x => x.ParentAccountId, x => x.ParentAccount, principalKeyExpression: x => x.AccountId);
      builder.RowVersion(x => x.MetaRowVersion);
    }
  }
}
